{% extends "base.html" %}

{% block title %}Adicionar Empréstimo{% endblock %}

{% block content %}
<h2><i class="bi bi-cash-coin"></i> Adicionar Empréstimo</h2>

<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-body">
                <form method="POST">
                    <div class="mb-3">
                        <label for="cliente_id" class="form-label fw-bold">Cliente</label>
                        <select class="form-select" id="cliente_id" name="cliente_id" required>
                            <option value="">Selecione um cliente</option>
                            {% for cliente in clientes %}
                            <option value="{{ cliente.id }}">{{ cliente.nome | capitalize }} - Cob. ({{ cliente.cobrador.usuario | upper }})</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="valor" class="form-label fw-bold">Valor do Empréstimo (R$)</label>
                        <input type="number" step="0.01" class="form-control" id="valor" name="valor" required>
                    </div>
                    <div class="mb-3">
                        <label for="porcentagem" class="form-label fw-bold">Porcentagem de Juros (%)</label>
                        <input type="number" step="0.01" class="form-control" id="porcentagem" name="porcentagem" required>
                    </div>
                    <div class="mb-3">
                        <label for="frequencia" class="form-label fw-bold">Frequência de Pagamento</label>
                        <select class="form-select" id="frequencia" name="frequencia" required>
                            <option value="diaria">Selecione uma opção</option>
                            <option value="diaria">Diária</option>
                            <option value="semanal">Semanal</option>
                            <option value="mensal">Mensal</option>
                        </select>
                    </div>
                    <div class="mb-3" id="qtd_parcelas_div" style="display: none;">
                        <label for="qtd_parcelas" class="form-label fw-bold">Quantidade de Parcelas (apenas para diária)</label>
                        <input type="number" class="form-control" id="qtd_parcelas" name="qtd_parcelas" placeholder="Ex: 20">
                    </div>
                    <div class="mb-3">
                        <label for="data_emprestimo" class="form-label fw-bold">Data do Empréstimo</label>
                        <input type="date" class="form-control" id="data_emprestimo" name="data_emprestimo" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Cadastrar Empréstimo</button>
                    <a href="{{ url_for('dashboard_admin') }}" class="btn btn-secondary">Cancelar</a>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
document.getElementById('frequencia').addEventListener('change', function() {
    var qtdParcelasDiv = document.getElementById('qtd_parcelas_div');
    if (this.value === 'diaria') {
        qtdParcelasDiv.style.display = 'block';
    } else {
        qtdParcelasDiv.style.display = 'none';
    }
});
</script>
{% endblock %}
